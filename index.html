<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Avon Payment Gateway</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body {
    margin: 0;
    font-family: 'Arial', sans-serif;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background: linear-gradient(to bottom, #a0d8ef, #00a859);
    overflow: hidden;
}
.droplet {
    position: absolute;
    background: rgba(255,255,255,0.7);
    border-radius: 50%;
    animation: drop 4s infinite linear;
}
@keyframes drop {
    0% { transform: translateY(-10px); opacity: 0; }
    50% { opacity: 1; }
    100% { transform: translateY(100vh); opacity: 0; }
}
.payment-card {
    background: rgba(255,255,255,0.95);
    border-radius: 15px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    width: 100%;
    max-width: 360px;
    padding: 25px 20px;
}
.payment-card h2 {
    color: #00a859;
    text-align: center;
    font-size: 1.6rem;
    margin-bottom: 20px;
    font-weight: bold;
}
.form-control {
    border-radius: 10px;
    padding: 10px;
}
.pay-btn {
    background-color: #00a859;
    border: none;
    width: 100%;
    font-size: 1.05rem;
    padding: 12px;
    border-radius: 10px;
    font-weight: bold;
    color: #fff;
    text-transform: uppercase;
    animation: blink 1.3s infinite;
}
@keyframes blink {
    0% { opacity: 1; }
    50% { opacity: 0.4; }
    100% { opacity: 1; }
}
.pay-btn:disabled {
    background-color: #a5d6a7;
    animation: none;
    cursor: not-allowed;
}
.footer-box {
    margin-top: 15px;
    text-align: center;
    font-size: 0.8rem;
    color: #444;
}
</style>
</head>
<body>

<div id="droplets-container"></div>

<div class="payment-card">
    <h2>Avon Payment Gateway</h2>
    <form id="paymentForm" novalidate>
        <div class="mb-3">
            <input type="text" class="form-control form-control-sm" id="fullName" placeholder="Your Name" required>
        </div>
        <div class="mb-3">
            <input type="tel" class="form-control form-control-sm" id="phoneNumber" placeholder="Enter 10-digit phone" maxlength="10" pattern="\\d{10}" required>
        </div>
        <div class="mb-3">
            <input type="date" class="form-control form-control-sm" id="deliveryDate" required>
        </div>
        <div class="mb-3">
            <input type="number" class="form-control form-control-sm" id="amount" placeholder="Amount" required>
        </div>
        <button type="button" class="btn pay-btn" id="payBtn" disabled>Pay Now</button>
    </form>
    <div class="footer-box">© 2025 Avon Payment Gateway. All Rights Reserved.</div>
</div>

<script>
// Generate droplets
const container = document.getElementById('droplets-container');
for(let i = 0; i < 60; i++) {
    const drop = document.createElement('div');
    drop.classList.add('droplet');
    drop.style.left = Math.random() * 100 + 'vw';
    drop.style.animationDuration = 2 + Math.random() * 3 + 's';
    drop.style.animationDelay = Math.random() * 5 + 's';
    drop.style.width = drop.style.height = 2 + Math.random() * 5 + 'px';
    container.appendChild(drop);
}

// Form validation
const fullName = document.getElementById("fullName");
const phoneNumber = document.getElementById("phoneNumber");
const deliveryDate = document.getElementById("deliveryDate");
const amount = document.getElementById("amount");
const payBtn = document.getElementById("payBtn");

deliveryDate.min = new Date().toISOString().split("T")[0];

function validateFields() {
    const nameValid = fullName.value.trim().length > 0;
    const phoneValid = /^\\d{10}$/.test(phoneNumber.value.trim());
    const dateValid = deliveryDate.value && deliveryDate.value >= deliveryDate.min;
    const amountValid = Number(amount.value) > 0;
    payBtn.disabled = !(nameValid && phoneValid && dateValid && amountValid);
}
[fullName, phoneNumber, deliveryDate, amount].forEach(input => 
    input.addEventListener('input', validateFields)
);

// Faster Payment Function (1 sec + auto-reset 15 sec)
function redirectToPayHero() {
    payBtn.disabled = true;
    payBtn.innerText = "Processing...";

    const accountId = "3513";
    const channelId = "3990";
    const name = fullName.value.trim();
    const phone = phoneNumber.value.trim();
    const amt = amount.value.trim();
    const reference = "REF" + Date.now();

    // ✅ Faster redirect (1 second)
    setTimeout(() => {
        window.location.href = 
        `https://app.payhero.co.ke/lipwa/${accountId}?amount=${amt}&phone=${phone}&name=${encodeURIComponent(name)}&channel_id=${channelId}&reference=${reference}`;
    }, 1000);

    // ✅ Clear form after 15 seconds
    setTimeout(() => {
        document.getElementById("paymentForm").reset();
        payBtn.innerText = "Pay Now";
        payBtn.disabled = true;
    }, 15000);
}

payBtn.addEventListener('click', redirectToPayHero);
</script>
</body>
</html>
